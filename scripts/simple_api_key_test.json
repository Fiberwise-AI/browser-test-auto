{
  "script_name": "simple_api_key_test",
  "description": "Simple test to verify API keys page with browser window and video recording",
  "version": "1.0",
  "settings": {
    "headless": true,
    "use_temp_instance": true,
    "video_recording": true,
    "take_screenshots": true,
    "auto_cleanup": false
  },
  "steps": [
    {
      "id": "setup",
      "type": "instance",
      "action": "create_temp_instance",
      "description": "Create and start temp FiberWise instance"
    },
    {
      "id": "register_user",
      "type": "browser",
      "action": "register_multiple_users",
      "description": "Register test user quickly in headless mode",
      "config": {
        "users": [
          {
            "username": "apiuser",
            "email": "api@example.com",
            "password": "TestPass123!"
          }
        ]
      }
    },
    {
      "id": "verify_user_in_db",
      "type": "command",
      "action": "verify_database",
      "description": "Verify user was saved to database",
      "config": {
        "queries": [
          "SELECT id, username, email FROM users WHERE username = 'apiuser';",
          "SELECT COUNT(*) as user_count FROM users;"
        ],
        "database_path": "{{instance_dir}}/local_data/fiberwise.db"
      }
    },
    {
      "id": "test_login",
      "type": "browser",
      "action": "test_login",
      "description": "Login and establish session",
      "config": {
        "username": "apiuser",
        "password": "TestPass123!",
        "keep_page_open": true,
        "take_screenshot": true
      }
    },
    {
      "id": "navigate_dashboard",
      "type": "browser",
      "action": "navigate_and_verify",
      "description": "Verify dashboard loads",
      "config": {
        "url": "/",
        "take_screenshot": true,
        "keep_page_open": true
      }
    },
    {
      "id": "navigate_api_keys",
      "type": "browser",
      "action": "navigate_and_verify",
      "description": "Navigate to API keys page",
      "config": {
        "url": "/settings/api-keys",
        "take_screenshot": true,
        "keep_page_open": true
      }
    },
    {
      "id": "analyze_logs",
      "type": "command",
      "action": "analyze_server_logs",
      "description": "Check server logs for any issues and performance stats",
      "config": {
        "log_types": ["error", "warning"],
        "check_auth_patterns": true,
        "include_performance": true,
        "generate_summary": true
      }
    }
  ]
}
